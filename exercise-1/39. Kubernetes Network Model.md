I

have some good and some bad news for you.

我有一些好消息和坏消息要告诉你。

It's all about networking in this

lecture. I'm going to describe some of the high level

concepts of how the networking model works in Kubernetes.

这节课都是关于网络的。我将描述一些关于 Kubernetes 中网络模型如何工作的高级概念。

The good news here is there is a lot of simplicity coming

out-of-the-box, and that is that there's

not a lot of ways you're allowed to add complexity here.

好消息是，开箱即用就提供了很多简单性，那就是，这里没有太多允许您增加复杂性的方法。

That can be a restriction sometimes when you're trying to

go across firewalls, or NAT layers, or different

data centers. That's why often people create clusters

that are just in one data center because of some of these

restrictions. You'll notice here that most of these talk

about that the nodes, and the pods, and everything there,

all need to be able to communicate with each other on a

big, flat network without NAT.

有时，当您尝试穿越防火墙，NAT层或其他数据中心时，这可能是一个限制。
这就是为什么人们经常由于某些限制而在一个数据中心中创建群集。
您会在这里注意到，其中大多数都是关于节点，pod 以及其中的所有内容，
所有这些都需要能够在没有 NAT 的大型扁平网络上相互通信。

You can have routing, but you

can't have translation. That's a good thing, because that

would just complicate things further.

你可以有路由，但不能有翻译。这是件好事，因为那样会使事情更复杂。

Often, whenever I'm dealing with someone's troubleshooting

on any of the container solutions, firewalls and NAT

are often part of the problem.

通常，每当我处理某人对任何容器解决方案的故障排除时，
防火墙和 NAT 常常是问题的一部分。

I've listed a bunch of good things here.

我在这里列出了很多好东西。

We've got, you can reach everything.

我们有，你可以接触到一切。

So, that's easy. There's no NAT.

所以，这很简单。没有 NAT。

There's no poor translation. There's no new, fancy

protocols required.

没有糟糕的翻译。 不需要新的花哨的协议。

There's no requirement that everything's in one IP

subnet. You can actually design it to where you maybe have

a subnet for each set of pods on different nodes so

that each node is its own subnet.

不要求所有内容都在一个 IP 子网中。
实际上，您可以将其设计为在不同节点上
为每组 pod 设置一个子网，
以便每个节点都是自己的子网。

It allows you to really be flexible with how you design the

subnetting in the networking here. But, that's where

things start to get tricky. The first up is that

everything, by default, can reach everything.

它允许您真正灵活地设计网络中的子网。
但是，这就是事情开始变得棘手的地方。
首先，默认情况下，所有东西都可以到达任何地方。

That's a big one.

We didn't have that necessarily before Kubernetes

where we would maybe put VLANs in or allow cloud

segments.

So, this one's a little bit tricky to deal with.

The way that Kubernetes deals with this is it

allows you to use a network implementation by a third

party. That, we mentioned earlier, is one of the choices

you have to make for your production clusters.

You have to decide which network implementation you're

going to use. There's over a dozen of them.

You might even recognize some of them that you've maybe

heard before, like Flannel, or Calico, or Kubenet.

Well, they're all pros and cons.

They each have its own set of features.

I usually recommend that you go with a cloud built version

that maybe is provided by your cloud hoster or

a distribution of Kubernetes.

All of those are going

to come out-of-the-box with their own preferences, which is both a

good and a bad thing.

The nice thing is for most people getting started is they

just don't want to have to get into the weeds of this yet.

Let's just make it work out-of-the-box.

But, the reality is, eventually you're going to need to

care as you get closer and closer to production and as your

production gets bigger. So, there's no requirement here

that you have to know all this on day one. If it works for

you now in learning, great.

As you build out your clusters, if

you're using someone else's distribution or Kubernetes that

they've provided, go with their defaults until you have

really hard requirements.

We've mentioned about kube-proxy being a potential source

of limitation here. But, in practice, it's really not.

Usually, in most situations, you're

not saturating 10Gb networks. And if you are, you're

already probably diving into the weeds of networking in Kubernetes

anyway.

You're probably someone who knows a lot about container

networking, in general, more than the average person.

When Docker came out, Docker was designed to make

networking easier

and more accessible to the non Cisco gurus out there.

Those of us that don't have all the Cisco certifications

and networking certifications don't

necessarily need to know about all the details of switch

configuration. That's what's great about Docker and Kubernetes is they

generally just work out-of-the-box.

Any of the providers that you choose for networking

Kubernetes will work out-of-the-box, with a lot of cases,

if you're doing the generic upstream vanilla of

Kubernetes. Remember, I don't always recommend that, and in

fact, I really only recommend it for learning.

For all my production deployments, I would always recommend

a cloud provided or a custom

distribution from a vendor. You'll notice down there at the

bottom that I have listed kube-router. You

can check out that project. It's an interesting replacement

for kube-proxy.

It has lots of benefits that they list there, but it's not

always needed. One of the challenges with Kubernetes is

everything seems to be so customizable that if

you kept customizing everything, eventually,

you would end up with a solution that only you could support. So,

I always encourage you to stick with the defaults as much

as possible to rein in your requirements and

limit the scope of those so that your solution is

looking more and more like all the other solutions out there, so

that you don't have a crazy, wild configuration that no one

else knows how it works.